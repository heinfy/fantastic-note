`React.useTransition` æ˜¯ React 18 å¼•å…¥çš„ä¸€ä¸ª **å¹¶å‘ç‰¹æ€§ï¼ˆConcurrent Featuresï¼‰** Hookï¼Œç”¨äºå°†**éç´§æ€¥çš„æ›´æ–°**æ ‡è®°ä¸ºâ€œè¿‡æ¸¡ï¼ˆtransitionï¼‰â€ï¼Œä»è€Œè®© React èƒ½å¤Ÿ**ä¼˜å…ˆå¤„ç†é«˜ä¼˜å…ˆçº§ä»»åŠ¡**ï¼ˆå¦‚ç”¨æˆ·è¾“å…¥ã€åŠ¨ç”»ï¼‰ï¼Œé¿å…ç•Œé¢å¡é¡¿ï¼Œæå‡ç”¨æˆ·ä½“éªŒã€‚

---

## âœ… æ ¸å¿ƒæ¦‚å¿µä¸€å¥è¯æ€»ç»“ï¼š

> **`useTransition` è®©ä½ å¯ä»¥æŠŠâ€œä¸é‚£ä¹ˆç´§æ€¥â€çš„çŠ¶æ€æ›´æ–°ï¼ˆæ¯”å¦‚æœç´¢ã€ç­›é€‰ã€åˆ‡æ¢æ ‡ç­¾é¡µï¼‰æ ‡è®°ä¸ºä½ä¼˜å…ˆçº§ï¼ŒReact ä¼šå…ˆå“åº”ç”¨æˆ·äº¤äº’ï¼Œå†å¤„ç†è¿™äº›æ›´æ–°ï¼Œä¿æŒ UI æµç•…ã€‚**

---

## ğŸ”§ åŸºæœ¬ç”¨æ³•

```jsx
import { useTransition, useState } from 'react';

function App() {
  const [isPending, startTransition] = useTransition();
  const [input, setInput] = useState('');
  const [items, setItems] = useState(largeList);

  const handleChange = (e) => {
    const value = e.target.value;
    setInput(value);

    // å°†â€œè¿‡æ»¤åˆ—è¡¨â€è¿™ä¸ªæ“ä½œæ ‡è®°ä¸º transitionï¼ˆä½ä¼˜å…ˆçº§ï¼‰
    startTransition(() => {
      setItems(
        largeList.filter(item => 
          item.name.toLowerCase().includes(value.toLowerCase())
        )
      );
    });
  };

  return (
    <div>
      <input value={input} onChange={handleChange} />
      
      {/* æ˜¾ç¤ºåŠ è½½çŠ¶æ€ï¼ˆå¯é€‰ï¼‰ */}
      {isPending && <div>æ­£åœ¨ç­›é€‰...</div>}
      
      <List items={items} />
    </div>
  );
}
```

---

## ğŸ“Œ `useTransition` è¿”å›ä»€ä¹ˆï¼Ÿ

```js
const [isPending, startTransition] = useTransition();
```

| è¿”å›å€¼ | ç±»å‹ | è¯´æ˜ |
|-------|------|------|
| `isPending` | boolean | è¡¨ç¤ºæ˜¯å¦æœ‰ transition æ­£åœ¨è¿›è¡Œï¼ˆå¯ç”¨äºæ˜¾ç¤º loadingï¼‰ |
| `startTransition` | function | ä¸€ä¸ªå‡½æ•°ï¼Œæ¥æ”¶ä¸€ä¸ªå›è°ƒï¼Œè¯¥å›è°ƒå†…çš„çŠ¶æ€æ›´æ–°ä¼šè¢«æ ‡è®°ä¸ºâ€œè¿‡æ¸¡æ›´æ–°â€ |

---

## âš¡ ä¸ºä»€ä¹ˆéœ€è¦ `useTransition`ï¼Ÿ

### åœºæ™¯ï¼šåœ¨å¤§å‹åˆ—è¡¨ä¸­æœç´¢

- ç”¨æˆ·åœ¨è¾“å…¥æ¡†æ‰“å­—ï¼ˆé«˜ä¼˜å…ˆçº§ï¼šå¿…é¡»å³æ—¶å“åº”ï¼‰
- æ¯æ¬¡è¾“å…¥éƒ½è¦è¿‡æ»¤ 10,000 æ¡æ•°æ®å¹¶é‡æ–°æ¸²æŸ“ï¼ˆä½ä¼˜å…ˆçº§ï¼šå¯ä»¥ç¨åå¤„ç†ï¼‰

âŒ **ä¸ç”¨ `useTransition` çš„é—®é¢˜**ï¼š
- æ‰“å­—æ—¶ç•Œé¢å¡é¡¿ï¼ˆå› ä¸º React è¢«å¤§è®¡ç®—é˜»å¡ï¼‰
- è¾“å…¥å»¶è¿Ÿï¼Œä½“éªŒå·®

âœ… **ç”¨äº† `useTransition` å**ï¼š
- è¾“å…¥æ¡†ç«‹å³å“åº”ï¼ˆé«˜ä¼˜å…ˆçº§ä»»åŠ¡ä¼˜å…ˆæ‰§è¡Œï¼‰
- åˆ—è¡¨æ›´æ–°è¢«â€œæ¨è¿Ÿâ€åˆ°æµè§ˆå™¨ç©ºé—²æ—¶å†å¤„ç†ï¼ˆä½ä¼˜å…ˆçº§ï¼‰
- å³ä½¿åˆ—è¡¨è¿˜æ²¡æ›´æ–°å®Œï¼Œç”¨æˆ·ä»å¯ç»§ç»­è¾“å…¥æˆ–ç‚¹å‡»å…¶ä»–æŒ‰é’®

> ğŸ’¡ React ä¼š**ä¸­æ–­**ä½ä¼˜å…ˆçº§çš„æ¸²æŸ“ï¼Œå»å¤„ç†æ–°çš„é«˜ä¼˜å…ˆçº§äº‹ä»¶ï¼ˆå¦‚æ–°æŒ‰é”®ï¼‰ï¼Œå®ç°â€œå¯ä¸­æ–­æ¸²æŸ“â€ã€‚

---

## ğŸ†š å¯¹æ¯”ï¼šæ™®é€šæ›´æ–° vs Transition æ›´æ–°

| è¡Œä¸º | æ™®é€š `setState` | `startTransition(setState)` |
|------|------------------|----------------------------|
| ä¼˜å…ˆçº§ | é«˜ï¼ˆç«‹å³æ¸²æŸ“ï¼‰ | ä½ï¼ˆå¯ä¸­æ–­ã€å¯æ¨è¿Ÿï¼‰ |
| æ˜¯å¦é˜»å¡ UI | æ˜¯ | å¦ |
| è§¦å‘ Suspense fallback | âŒ ä¸ä¼š | âœ… ä¼šï¼ˆå¦‚æœé…åˆ Suspenseï¼‰ |
| `isPending` çŠ¶æ€ | æ—  | æœ‰ï¼ˆå¯ç”¨äº loading æç¤ºï¼‰ |

---

## ğŸ§ª å®é™…æ•ˆæœæ¼”ç¤º

å‡è®¾ä½ æœ‰ä¸€ä¸ªæ…¢æ“ä½œï¼š

```jsx
// æ¨¡æ‹Ÿè€—æ—¶è®¡ç®—
const filterItems = (query) => {
  const start = Date.now();
  while (Date.now() - start < 2000) {} // é˜»å¡ 2 ç§’ï¼
  return originalList.filter(...);
};
```

- **ä¸ç”¨ transition**ï¼šç‚¹å‡»æŒ‰é’®åï¼Œæ•´ä¸ªé¡µé¢å†»ç»“ 2 ç§’ã€‚
- **ç”¨ transition**ï¼šç‚¹å‡»å UI ä¾ç„¶å¯äº¤äº’ï¼ˆæ¯”å¦‚è¿˜èƒ½ç‚¹å–æ¶ˆï¼‰ï¼Œ2 ç§’åç»“æœæ‰å‡ºç°ã€‚

---

## âš ï¸ æ³¨æ„äº‹é¡¹

### 1. **åªèƒ½ç”¨äºçŠ¶æ€æ›´æ–°**
```js
startTransition(() => {
  setCount(c => c + 1); // âœ… OK
  fetchData();           // âŒ æ— æ•ˆï¼å¼‚æ­¥æ“ä½œä¸ä¼šè¢«æ ‡è®°ä¸º transition
});
```

> `startTransition` åªå½±å“ **åŒæ­¥çš„çŠ¶æ€æ›´æ–°**ã€‚å¦‚æœä½ è¦ç»“åˆæ•°æ®è¯·æ±‚ï¼Œéœ€é…åˆ `Suspense` + ç¼“å­˜ï¼ˆå¦‚ Relayã€SWRï¼‰ã€‚

---

### 2. **ä¸è¦ç”¨äºç´§æ€¥æ›´æ–°**
ä»¥ä¸‹æƒ…å†µ**ä¸è¦ç”¨** `useTransition`ï¼š
- è¡¨å•æäº¤
- æŒ‰é’®ç‚¹å‡»åé¦ˆï¼ˆå¦‚â€œå·²æ·»åŠ åˆ°è´­ç‰©è½¦â€ï¼‰
- ä»»ä½•éœ€è¦**ç«‹å³è§†è§‰åé¦ˆ**çš„æ“ä½œ

---

### 3. **ä¸ `useDeferredValue` çš„åŒºåˆ«**

| Hook | ç”¨é€” |
|------|------|
| `useTransition` | **ä¸»åŠ¨è§¦å‘**ä¸€ä¸ªä½ä¼˜å…ˆçº§æ›´æ–°ï¼ˆä½ æ§åˆ¶ä½•æ—¶å¼€å§‹ï¼‰ |
| `useDeferredValue` | **è¢«åŠ¨å»¶è¿Ÿ**æŸä¸ªå€¼çš„æ›´æ–°ï¼ˆå¸¸ç”¨äºè¾“å…¥é˜²æŠ–åœºæ™¯ï¼‰ |

```jsx
// useDeferredValue ç¤ºä¾‹
const deferredQuery = useDeferredValue(inputValue);
// å½“ inputValue å˜åŒ–å¿«æ—¶ï¼ŒdeferredQuery ä¼šæ»åï¼Œé¿å…é¢‘ç¹é‡æ¸²æŸ“
```

---

## âœ… æœ€ä½³å®è·µ

1. **ç”¨äºæœç´¢ã€ç­›é€‰ã€æ ‡ç­¾åˆ‡æ¢ç­‰â€œéå³æ—¶â€æ“ä½œ**
2. **é…åˆ `isPending` æ˜¾ç¤ºå¾®å¼± loadingï¼ˆä¸è¦ç”¨å…¨å±é®ç½©ï¼ï¼‰**
   ```jsx
   {isPending && <Spinner size="small" />}
   ```
3. **ä¸è¦åŒ…è£¹å¼‚æ­¥é€»è¾‘**ï¼ˆå¦‚ API è°ƒç”¨ï¼‰ï¼Œå®ƒåªå½±å“ React çš„æ¸²æŸ“è°ƒåº¦

---

## ğŸŒ æµè§ˆå™¨å…¼å®¹æ€§

- éœ€è¦ **React 18+**
- ä¾èµ– React çš„å¹¶å‘æ¸²æŸ“æœºåˆ¶ï¼ˆè‡ªåŠ¨å¯ç”¨ï¼Œæ— éœ€é¢å¤–é…ç½®ï¼‰

---

## âœ… æ€»ç»“

| å…³é”®ç‚¹ | è¯´æ˜ |
|-------|------|
| **ç›®çš„** | é¿å…éå…³é”®æ›´æ–°é˜»å¡ UIï¼Œæå‡å“åº”æ€§ |
| **æ ¸å¿ƒ API** | `const [isPending, startTransition] = useTransition()` |
| **ä½¿ç”¨æ–¹å¼** | æŠŠ setState åŒ…åœ¨ `startTransition(() => { ... })` ä¸­ |
| **é€‚ç”¨åœºæ™¯** | æœç´¢ã€ç­›é€‰ã€å¤æ‚åˆ—è¡¨æ›´æ–°ç­‰ |
| **ä¸é€‚ç”¨åœºæ™¯** | è¡¨å•æäº¤ã€å³æ—¶åé¦ˆã€å¼‚æ­¥è¯·æ±‚ |

> ğŸ’¡ **è®°ä½**ï¼š  
> **â€œç”¨æˆ·è¾“å…¥æ˜¯çš‡å¸ï¼Œå…¶ä»–éƒ½æ˜¯è‡£æ°‘ã€‚â€**  
> ç”¨ `useTransition` ç»™â€œè‡£æ°‘â€æ’é˜Ÿï¼Œè®©â€œçš‡å¸â€ä¼˜å…ˆé€šè¡Œï¼

è¿™æ˜¯æ„å»º**æµç•…ã€ä¸“ä¸šçº§ React åº”ç”¨**çš„é‡è¦å·¥å…·ä¹‹ä¸€ã€‚