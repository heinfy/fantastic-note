`React.useTransition` å’Œ `useDeferredValue` éƒ½æ˜¯ React 18 å¼•å…¥çš„ **å¹¶å‘ç‰¹æ€§ï¼ˆConcurrent Featuresï¼‰**ï¼Œç”¨äºä¼˜åŒ– UI å“åº”æ€§ï¼Œé¿å…å› é«˜å¼€é”€æ›´æ–°å¯¼è‡´ç•Œé¢å¡é¡¿ã€‚  
ä½†å®ƒä»¬çš„**ä½¿ç”¨åœºæ™¯ã€æ§åˆ¶æ–¹å¼å’Œä½œç”¨å¯¹è±¡**æœ‰æœ¬è´¨åŒºåˆ«ã€‚

---

## âœ… ä¸€å¥è¯æ€»ç»“åŒºåˆ«

| Hook | æ§åˆ¶æ–¹å¼ | ä½œç”¨å¯¹è±¡ | å…¸å‹åœºæ™¯ |
|------|--------|--------|--------|
| **`useTransition`** | **ä¸»åŠ¨è§¦å‘**ä¸€ä¸ªä½ä¼˜å…ˆçº§æ›´æ–° | **çŠ¶æ€æ›´æ–°é€»è¾‘æœ¬èº«** | â€œç‚¹å‡»æŒ‰é’®åå»¶è¿Ÿæ›´æ–°åˆ—è¡¨â€ |
| **`useDeferredValue`** | **è¢«åŠ¨å»¶è¿Ÿ**æŸä¸ªå€¼çš„æ¸²æŸ“ | **æŸä¸ªå…·ä½“ state çš„â€œå»¶è¿Ÿå‰¯æœ¬â€** | â€œè¾“å…¥æ¡†æ‰“å­—æ—¶é˜²æŠ–å¼è¿‡æ»¤åˆ—è¡¨â€ |

---

## ğŸ” è¯¦ç»†å¯¹æ¯”

### 1. **`useTransition`ï¼šä¸»åŠ¨æ ‡è®°â€œè¿™ä¸ªæ›´æ–°ä¸ç´§æ€¥â€**

- ä½ **æ˜¾å¼è°ƒç”¨** `startTransition` æ¥åŒ…è£¹çŠ¶æ€æ›´æ–°ã€‚
- é€‚ç”¨äº**ç”±ç”¨æˆ·æ“ä½œè§¦å‘çš„éç´§æ€¥æ›´æ–°**ï¼ˆå¦‚æœç´¢ã€ç­›é€‰ã€åˆ‡æ¢æ ‡ç­¾ï¼‰ã€‚
- ä½ å¯ä»¥è·å¾— `isPending` çŠ¶æ€ç”¨äºæ˜¾ç¤º loadingã€‚

#### ğŸ“Œ ç¤ºä¾‹ï¼šç‚¹å‡»æŒ‰é’®åè¿‡æ¸¡æ›´æ–°
```jsx
const [isPending, startTransition] = useTransition();
const [tab, setTab] = useState('all');

const handleTabChange = (newTab) => {
  // ç«‹å³æ›´æ–° tabï¼ˆé«˜ä¼˜å…ˆçº§ï¼‰
  setTab(newTab);
  
  // å°†è€—æ—¶çš„åˆ—è¡¨è¿‡æ»¤æ ‡è®°ä¸ºä½ä¼˜å…ˆçº§
  startTransition(() => {
    setFilteredItems(expensiveFilter(newTab));
  });
};

return (
  <div>
    <button onClick={() => handleTabChange('active')}>Active</button>
    {isPending && <Spinner />} {/* å¯æ˜¾ç¤º loading */}
    <ItemList items={filteredItems} />
  </div>
);
```

> âœ… **ä½ æ§åˆ¶ä½•æ—¶å¼€å§‹ transition**ã€‚

---

### 2. **`useDeferredValue`ï¼šè‡ªåŠ¨å»¶è¿Ÿâ€œè¿™ä¸ªå€¼çš„æ¸²æŸ“â€**

- ä½ ä¼ å…¥ä¸€ä¸ª **å½“å‰å€¼ï¼ˆå¦‚ input è¾“å…¥ï¼‰**ï¼Œå®ƒè¿”å›ä¸€ä¸ª **å»¶è¿Ÿç‰ˆæœ¬çš„å€¼**ã€‚
- å½“åŸå§‹å€¼å˜åŒ–å¾ˆå¿«æ—¶ï¼Œå»¶è¿Ÿå€¼ä¼šâ€œæ»åâ€ï¼Œé¿å…é¢‘ç¹é‡æ¸²æŸ“ã€‚
- **æ— éœ€æ‰‹åŠ¨è§¦å‘**ï¼ŒReact è‡ªåŠ¨ç®¡ç†å»¶è¿Ÿã€‚

#### ğŸ“Œ ç¤ºä¾‹ï¼šè¾“å…¥æ¡†å®æ—¶æœç´¢ï¼ˆé˜²æŠ–æ•ˆæœï¼‰
```jsx
const [inputValue, setInputValue] = useState('');
// åˆ›å»ºä¸€ä¸ªâ€œå»¶è¿Ÿç‰ˆæœ¬â€çš„ inputValue
const deferredValue = useDeferredValue(inputValue);

// åˆ—è¡¨åªåœ¨ deferredValue ç¨³å®šæ—¶æ‰æ›´æ–°
const filteredList = useMemo(() => 
  list.filter(item => item.includes(deferredValue)),
  [deferredValue] // æ³¨æ„ï¼šä¾èµ–çš„æ˜¯ deferredValueï¼
);

return (
  <div>
    <input 
      value={inputValue}
      onChange={e => setInputValue(e.target.value)} // ç«‹å³å“åº”è¾“å…¥
    />
    {/* å³ä½¿ inputValue é¢‘ç¹å˜ï¼ŒfilteredList ä¸ä¼šç«‹å³é‡ç®— */}
    <ItemList items={filteredList} />
  </div>
);
```

> âœ… **React è‡ªåŠ¨å†³å®šä½•æ—¶æ›´æ–° deferredValue**ï¼ˆåœ¨æµè§ˆå™¨ç©ºé—²æ—¶ï¼‰ã€‚

---

## ğŸ†š æ ¸å¿ƒå·®å¼‚å¯¹æ¯”è¡¨

| ç‰¹æ€§ | `useTransition` | `useDeferredValue` |
|------|------------------|---------------------|
| **è°å‘èµ·æ›´æ–°** | å¼€å‘è€…ä¸»åŠ¨è°ƒç”¨ `startTransition` | React è‡ªåŠ¨ç®¡ç† |
| **æ§åˆ¶ç²’åº¦** | æ•´ä¸ªçŠ¶æ€æ›´æ–°è¿‡ç¨‹ | å•ä¸ªå€¼çš„æ¸²æŸ“ |
| **æ˜¯å¦éœ€è¦ `isPending`** | âœ… æ˜¯ï¼ˆç”¨äº loadingï¼‰ | âŒ å¦ï¼ˆæ—  pending çŠ¶æ€ï¼‰ |
| **é€‚ç”¨æ“ä½œ** | æŒ‰é’®ç‚¹å‡»ã€åˆ‡æ¢ç­‰ç¦»æ•£æ“ä½œ | è¾“å…¥æ¡†ã€æ»‘å—ç­‰è¿ç»­è¾“å…¥ |
| **èƒ½å¦ä¸­æ–­** | âœ… èƒ½ï¼ˆé«˜ä¼˜ä»»åŠ¡å¯æ‰“æ–­ï¼‰ | âœ… èƒ½ |
| **å…¸å‹ç”¨é€”** | â€œæ‰§è¡Œä¸€ä¸ªè€—æ—¶æ“ä½œâ€ | â€œè®©æŸä¸ªå€¼çš„å˜åŒ–æ›´å¹³æ»‘â€ |
| **ä»£ç ä½ç½®** | åœ¨äº‹ä»¶å¤„ç†å‡½æ•°ä¸­ | åœ¨ç»„ä»¶ render é€»è¾‘ä¸­ |

---

## ğŸ§ª åœºæ™¯é€‰æ‹©æŒ‡å—

### âœ… ç”¨ `useTransition` å½“ï¼š
- ç”¨æˆ·ç‚¹å‡»â€œæœç´¢â€æŒ‰é’®åè§¦å‘è¿‡æ»¤
- åˆ‡æ¢æ ‡ç­¾é¡µæ—¶åŠ è½½æ–°æ•°æ®
- ä½ éœ€è¦**æ˜ç¡®çŸ¥é“æ›´æ–°ä½•æ—¶å¼€å§‹**ï¼Œå¹¶å¯èƒ½æ˜¾ç¤º loading

### âœ… ç”¨ `useDeferredValue` å½“ï¼š
- ç”¨æˆ·åœ¨è¾“å…¥æ¡†æ‰“å­—ï¼Œå®æ—¶è¿‡æ»¤åˆ—è¡¨ï¼ˆæ— éœ€ç‚¹å‡»æœç´¢ï¼‰
- æ‹–åŠ¨æ»‘å—è°ƒæ•´å‚æ•°ï¼Œå®æ—¶é¢„è§ˆæ•ˆæœ
- ä½ æƒ³**è‡ªåŠ¨é˜²æŠ–**æŸä¸ªé«˜é¢‘å˜åŒ–çš„å€¼ï¼Œä¸”**ä¸éœ€è¦ loading æç¤º**

---

## âš ï¸ å¸¸è§è¯¯åŒº

### âŒ è¯¯åŒº 1ï¼š`useDeferredValue` æ˜¯ `useTransition` çš„ç®€åŒ–ç‰ˆ  
â†’ ä¸æ˜¯ï¼å®ƒä»¬è§£å†³ä¸åŒé—®é¢˜ã€‚`useDeferredValue` æœ¬è´¨æ˜¯åˆ›å»ºä¸€ä¸ªâ€œå»¶è¿Ÿæ´¾ç”ŸçŠ¶æ€â€ã€‚

### âŒ è¯¯åŒº 2ï¼šå¯ä»¥ç”¨ `useDeferredValue` æ›¿ä»£æ‰€æœ‰ `useTransition`  
â†’ ä¸è¡Œï¼å¦‚æœä½ éœ€è¦**åœ¨æ›´æ–°å‰åšå¼‚æ­¥æ“ä½œ**ï¼ˆå¦‚ API è°ƒç”¨ï¼‰ï¼Œå¿…é¡»ç”¨ `useTransition` + `Suspense`ã€‚

### âœ… æ­£ç¡®ç»„åˆä½¿ç”¨ï¼ˆé«˜çº§ï¼‰ï¼š
```jsx
// å…ˆç”¨ useDeferredValue è·å–ç¨³å®šæŸ¥è¯¢è¯
const deferredQuery = useDeferredValue(query);

// å†ç”¨ useTransition è§¦å‘å®é™…æœç´¢ï¼ˆå¦‚æœæ¶‰åŠ Suspenseï¼‰
useEffect(() => {
  if (deferredQuery) {
    startTransition(() => {
      setSearchResult(api.search(deferredQuery)); // å¯èƒ½æŠ›å‡º Promiseï¼ˆè§¦å‘ Suspenseï¼‰
    });
  }
}, [deferredQuery]);
```

---

## âœ… æ€»ç»“è®°å¿†å£è¯€

> - **`useTransition` â†’ â€œæˆ‘æ¥å®‰æ’â€**ï¼šä½ ä¸»åŠ¨è¯´ï¼šâ€œæ¥ä¸‹æ¥è¿™ä¸ªæ›´æ–°ä¸æ€¥ï¼Œå…ˆå¹²åˆ«çš„ã€‚â€
> - **`useDeferredValue` â†’ â€œä½ æ…¢æ…¢æ¥â€**ï¼šä½ å‘Šè¯‰ Reactï¼šâ€œè¿™ä¸ªå€¼å˜å¤ªå¿«ï¼Œä½ æ‰¾ä¸ªç©ºé—²å†ç”¨å®ƒã€‚â€

ä¸¤è€…éƒ½æ˜¯ä¸ºäº† **è®© React ä¼˜å…ˆå“åº”ç”¨æˆ·äº¤äº’**ï¼Œä½†ä¸€ä¸ªæ˜¯ä½ **å‘å·æ–½ä»¤**ï¼Œä¸€ä¸ªæ˜¯è®© React**è‡ªä¸»è°ƒåº¦**ã€‚

åˆç†ä½¿ç”¨å®ƒä»¬ï¼Œä½ çš„åº”ç”¨å°†æ‹¥æœ‰ **60fps çš„æµç•…ä½“éªŒ**ï¼