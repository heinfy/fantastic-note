---
sidebar_position: 2
title: Docker é…ç½®
---

---

## ğŸ“Œä¿®æ”¹é•œåƒæº

### 1. åˆ›å»ºæˆ–ä¿®æ”¹ Docker é…ç½®æ–‡ä»¶

Docker çš„é…ç½®æ–‡ä»¶ `daemon.json` é€šå¸¸ä½äº `/etc/docker/` ç›®å½•ä¸‹ã€‚å¦‚æœè¯¥æ–‡ä»¶ä¸å­˜åœ¨ï¼Œéœ€è¦å…ˆåˆ›å»ºå®ƒã€‚

```bash
sudo mkdir -p /etc/docker
sudo tee /etc/docker/daemon.json <<-'EOF'
{
  "registry-mirrors": [
    "https://docker.mirrors.ustc.edu.cn",
    "https://registry.docker-cn.com",
  ]
}
EOF
```

> **è¯´æ˜**ï¼š
>
> - ä»¥ä¸Šé…ç½®æ·»åŠ äº†å¤šä¸ªå›½å†…å¸¸ç”¨çš„é•œåƒæºï¼ŒDocker ä¼šæŒ‰é¡ºåºå°è¯•ä½¿ç”¨å®ƒä»¬ã€‚
> - **ä¸­ç§‘å¤§é•œåƒæº**: `https://docker.mirrors.ustc.edu.cn`
> - **Docker ä¸­å›½å®˜æ–¹é•œåƒæº**: `https://registry.docker-cn.com` (æ³¨æ„ï¼šæ­¤æºæœ‰æ—¶å¯èƒ½ä¸ç¨³å®š)

> **å»ºè®®**ï¼šä½ å¯ä»¥æ ¹æ®è‡ªå·±çš„ç½‘ç»œç¯å¢ƒé€‰æ‹©ä¸€ä¸ªæˆ–å¤šä¸ªã€‚ä¾‹å¦‚ï¼Œå¦‚æœä½ åœ¨æ•™è‚²ç½‘ï¼Œä¸­ç§‘å¤§æºé€šå¸¸éå¸¸å¿«ã€‚

### 2. é‡å¯ Docker æœåŠ¡

ä¿®æ”¹é…ç½®åï¼Œå¿…é¡»é‡å¯ Docker æœåŠ¡æ‰èƒ½ä½¿æ›´æ”¹ç”Ÿæ•ˆã€‚

```bash
sudo systemctl daemon-reload
sudo systemctl restart docker
```

### 3. éªŒè¯é…ç½®æ˜¯å¦ç”Ÿæ•ˆ

ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤æŸ¥çœ‹ Docker çš„ç³»ç»Ÿä¿¡æ¯ï¼Œæ£€æŸ¥é•œåƒæºæ˜¯å¦å·²æ­£ç¡®é…ç½®ã€‚

```bash
sudo docker info
```

åœ¨è¾“å‡ºçš„ä¿¡æ¯ä¸­ï¼Œæ‰¾åˆ° `Registry Mirrors` è¿™ä¸€é¡¹ï¼Œä½ åº”è¯¥èƒ½çœ‹åˆ°ç±»ä¼¼ä»¥ä¸‹çš„å†…å®¹ï¼š

```plain
Registry Mirrors:
  https://mirror.baidubce.com/
  https://registry.docker-cn.com/
  https://hub-mirror.c.163.com/
  https://docker.mirrors.ustc.edu.cn/
```

å¦‚æœçœ‹åˆ°è¿™äº›åœ°å€ï¼Œè¯´æ˜é•œåƒæºé…ç½®å·²ç»æˆåŠŸã€‚

### 4. ï¼ˆå¯é€‰ï¼‰æµ‹è¯•æ‹‰å–é•œåƒ

å¯ä»¥å°è¯•æ‹‰å–ä¸€ä¸ªå¸¸ç”¨çš„é•œåƒæ¥æµ‹è¯•é€Ÿåº¦æ˜¯å¦æå‡ã€‚

```bash
sudo docker pull hello-world
```

å¦‚æœé…ç½®æ­£ç¡®ï¼Œæ‹‰å–é€Ÿåº¦åº”è¯¥ä¼šæ¯”ä¹‹å‰å¿«å¾ˆå¤šã€‚

---

### æ³¨æ„äº‹é¡¹

- **æƒé™**ï¼šæ“ä½œ `/etc/docker/` ç›®å½•å’Œé‡å¯æœåŠ¡éœ€è¦ `root` æƒé™ï¼Œæ‰€ä»¥å‘½ä»¤å‰éœ€è¦åŠ  `sudo`ã€‚
- **JSON æ ¼å¼**ï¼š`daemon.json` æ˜¯ä¸€ä¸ª JSON æ–‡ä»¶ï¼Œå¿…é¡»ä¿è¯æ ¼å¼æ­£ç¡®ï¼Œé¿å…å¤šä½™çš„é€—å·æˆ–ç¼ºå°‘å¼•å·ï¼Œå¦åˆ™ Docker å¯èƒ½æ— æ³•å¯åŠ¨ã€‚
- **äº‘æœåŠ¡å•†é•œåƒæº**ï¼šå¦‚æœä½ ä½¿ç”¨çš„æ˜¯é˜¿é‡Œäº‘ã€è…¾è®¯äº‘ç­‰äº‘æœåŠ¡å™¨ï¼Œå»ºè®®ä½¿ç”¨è¯¥äº‘æœåŠ¡å•†æä¾›çš„ä¸“å±é•œåƒåŠ é€Ÿå™¨ï¼Œé€šå¸¸é€Ÿåº¦æ›´å¿«ã€æ›´ç¨³å®šã€‚ä½ å¯ä»¥åœ¨å¯¹åº”äº‘å¹³å°çš„å®¹å™¨é•œåƒæœåŠ¡æ§åˆ¶å°æ‰¾åˆ°ä½ çš„ä¸“å±åŠ é€Ÿå™¨åœ°å€ã€‚
- **Docker ç‰ˆæœ¬**ï¼šä»¥ä¸Šæ–¹æ³•é€‚ç”¨äºè¾ƒæ–°ç‰ˆæœ¬çš„ Dockerï¼ˆ1.10+ï¼‰ã€‚å¯¹äºéå¸¸è€çš„ç‰ˆæœ¬ï¼Œå¯èƒ½éœ€è¦é€šè¿‡ä¿®æ”¹å¯åŠ¨è„šæœ¬ï¼ˆå¦‚ `/etc/default/docker`ï¼‰æ¥é…ç½®ï¼Œä½†è¿™ç§æ–¹æ³•ç°åœ¨å·²ä¸æ¨èã€‚

æŒ‰ç…§ä»¥ä¸Šæ­¥éª¤æ“ä½œï¼Œå³å¯æˆåŠŸä¿®æ”¹ Linux ä¸Š Docker çš„é•œåƒæºã€‚

## âœ… åœºæ™¯ä¸€ï¼š**ä»è¿œç¨‹ä»“åº“ä¸‹è½½é•œåƒ**

è¿™æ˜¯æœ€å¸¸è§çš„â€œä¸‹è½½é•œåƒâ€æ“ä½œã€‚

### ğŸ”§ å‘½ä»¤ï¼š`docker pull`

```bash
docker pull é•œåƒå:æ ‡ç­¾
```

### ğŸ“Œ ç¤ºä¾‹ï¼š

```bash
# ä» Docker Hub ä¸‹è½½ Nginx æœ€æ–°é•œåƒ
docker pull nginx:latest

# ä¸‹è½½ç‰¹å®šç‰ˆæœ¬
docker pull ubuntu:22.04

# ä»é˜¿é‡Œäº‘ç§æœ‰ä»“åº“ä¸‹è½½
docker pull registry.cn-beijing.aliyuncs.com/your-namespace/your-image:v1.0
```

### âœ… éªŒè¯æ˜¯å¦ä¸‹è½½æˆåŠŸï¼š

```bash
docker images
```

ä½ ä¼šçœ‹åˆ°åˆšä¸‹è½½çš„é•œåƒå‡ºç°åœ¨åˆ—è¡¨ä¸­ã€‚

---

## âœ… åœºæ™¯äºŒï¼š**æœåŠ¡å™¨â€œè¿ç§»â€**

å³ï¼š**å¯¼å‡ºä¸€ä¸ªé•œåƒä¸ºæ–‡ä»¶ï¼Œå¤åˆ¶åˆ°æœ¬æœºï¼Œå†å¯¼å…¥**ã€‚

### æ­¥éª¤ 1ï¼šåœ¨æºæœåŠ¡å™¨ä¸Šå¯¼å‡ºé•œåƒä¸º `.tar` æ–‡ä»¶

```bash
docker save é•œåƒå:æ ‡ç­¾ -o é•œåƒå.tar
```

#### ç¤ºä¾‹ï¼š

```bash
docker save myapp:v1.0 -o myapp-v1.0.tar
```

### æ­¥éª¤ 2ï¼šå°† `.tar` æ–‡ä»¶å¤åˆ¶åˆ°å½“å‰æœåŠ¡å™¨ï¼ˆä½¿ç”¨ `scp`, `rsync`, `wget` ç­‰ï¼‰

```bash
# ä»å½“å‰æœåŠ¡å™¨æ‹‰å–æ–‡ä»¶
scp user@æºæœåŠ¡å™¨IP:/path/to/myapp-v1.0.tar ./
```

### æ­¥éª¤ 3ï¼šåœ¨å½“å‰æœåŠ¡å™¨å¯¼å…¥é•œåƒ

```bash
docker load -i myapp-v1.0.tar
```

### âœ… éªŒè¯ï¼š

```bash
docker images
```

---

## âœ… åœºæ™¯ä¸‰ï¼š**ä»ç§æœ‰ä»“åº“ç™»å½•å¹¶ä¸‹è½½é•œåƒ**

éœ€è¦å…ˆç™»å½•ï¼š

```bash
docker login registry.yourcompany.com
```

ç„¶åï¼š

```bash
docker pull registry.yourcompany.com/project/app:v1.2
```

---

## âœ… åœºæ™¯å››ï¼š**è¿è¡Œçš„å®¹å™¨ä¿å­˜ä¸ºé•œåƒ**

### æ­¥éª¤ 1ï¼šå°†å®¹å™¨ä¿å­˜ä¸ºé•œåƒ

```bash
docker commit å®¹å™¨ID æ–°é•œåƒå:æ ‡ç­¾
```

ä¾‹å¦‚ï¼š

```bash
docker commit abc123 myapp-custom:v1
```

### æ­¥éª¤ 2ï¼šå¯¼å‡ºä¸ºæ–‡ä»¶ï¼ˆå¯é€‰ï¼‰

```bash
docker save myapp-custom:v1 -o myapp-custom-v1.tar
```

ç„¶åä½ å¯ä»¥æŠŠè¿™ä¸ª `.tar` æ–‡ä»¶å‘ç»™åˆ«äººæˆ–ä¼ åˆ°å…¶ä»–æœåŠ¡å™¨ã€‚

---

## âœ… åœºæ™¯äº”ï¼š**ä¸‹è½½é•œåƒç”¨äºç¦»çº¿éƒ¨ç½²**

**æ‰¹é‡å¯¼å‡ºå¤šä¸ªé•œåƒï¼š**

```bash
# å¯¼å‡ºå¤šä¸ªé•œåƒåˆ°ä¸€ä¸ª tar æ–‡ä»¶
docker save é•œåƒ1:v1 é•œåƒ2:v2 ubuntu:22.04 -o all-images.tar

# åœ¨å¦ä¸€å°æœºå™¨å¯¼å…¥
docker load -i all-images.tar
```

---

## ğŸ“Œ æ€»ç»“ï¼šå¸¸ç”¨å‘½ä»¤é€ŸæŸ¥

| ç›®çš„             | å‘½ä»¤                            |
| ---------------- | ------------------------------- |
| ä»ç½‘ç»œä¸‹è½½é•œåƒ   | `docker pull nginx:latest`      |
| å¯¼å‡ºé•œåƒä¸ºæ–‡ä»¶   | `docker save é•œåƒ -o æ–‡ä»¶.tar`  |
| å¯¼å…¥é•œåƒ         | `docker load -i æ–‡ä»¶.tar`       |
| å°†å®¹å™¨ä¿å­˜ä¸ºé•œåƒ | `docker commit å®¹å™¨ID æ–°é•œåƒå` |
| æŸ¥çœ‹å·²æœ‰é•œåƒ     | `docker images`                 |

---
